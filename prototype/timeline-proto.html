<!DOCTYPE html>
<html>
<head><title>Timeline Prototype</title></head>
<body>
  <pg-timeline-viewer width="1000" height="400">
    <pg-timeline>
      <pg-event x="20" label="Foo" />
      <pg-event start-x="25" end-x="30" label="Bar" />
    </pg-timeline>
  </pg-timeline-viewer>
</body>
<script>
var polygraph = (() => {
  'use strict';
  
  var polygraph = {};
  const polygraphPrefix = 'pg-';

  class AbstractMethodError {}
  
  class Axis {
    min(lhsVal, rhsVal) {
      return ( lhsVal <= rhsVal ) ? lhsVal : rhsVal;
    }
    
    toPixel(val, minVal, maxVal, maxPixel) {
      throw new AbstractMethodError('toPixel');
    }
  }
  polygraph.Axis = Axis;
    
  var axisDefs = {};
  polygraph.defineAxis = (name, axis) => {
    axisDefs[name] = axis;
  };
  
  class RawAxis extends Axis {
    toPixel(val, minVal, maxVal, maxPixel) {
      return val;
    }
  }
  
  
  class AxisModel {
    constructor(axis) {
      this._axis = axis;
    }
    
    min(lhsVal, rhsVal) {
      return this._xAxis.min(lhsVal, rhsVal);
    }
    
    get bounds() {
      return {min: this._min, max: this._max};
    }
  }
  
  var createAttributeNSProperty = (element, ns, prop) => {
    return {
      get() {
        return element.getAttributeNS(ns, prop);
      },
      
      set(val) {
        return element.setAttributeNS(ns, prop, val);
      }
    };
  };
  
  const svgNamespace = 'http://www.w3.org/2000/svg';
  class SvgViewportMixin {
    constructor(optSvg) {
      this._svg = optSvg || document.createElementNS(svgNamespace, 'svg');
    }
    
    connect(viewerElement) {
      Object.defineProperty(viewerElement, 'width', createAttributeNSProperty(this._svg, null, 'width'));
      Object.defineProperty(viewerElement, 'height', createAttributeNSProperty(this._svg, null, 'height'));
      
      if ( viewerElement.hasAttribute('width') ) {
        viewerElement.width = viewerElement.getAttribute('width');
      }
      if ( viewerElement.hasAttribute('height') ) {
        viewerElement.height = viewerElement.getAttribute('height'); 
      }
    }
    
    get element() {
      return this._svg;
    }
  }
  
  class AbstractViewer extends HTMLElement {
    constructor() {
      super();
      
      const shadowRoot = this.attachShadow({mode: 'open'});
      
      this._viewport = new SvgViewportMixin();
      shadowRoot.appendChild(this._viewport.element);
    }
  }

  class TimelineViewer extends AbstractViewer {
    constructor() {
      super();
    }
    
    connectedCallback() {
      this._viewport.connect(this);
    }
  }
  
  class Timeline extends HTMLElement {
    constructor() {
      super();
    }
    
    set label(label) {
      return this.setAttribute('label', label);
    }
    
    get label() {
      return this.getAttribute('label');
    }
  }
  
  class TimelineEvent extends HTMLElement {
    constructor() {
      super();
    }
    
    set label(label) {
      return this.setAttribute('label', label);
    }
    
    get label() {
      return this.getAttribute('label');
    }
    
    set x(x) {
      this.startX = x;
      this.endX = x;
    }
    
    set startX(x) {
      return this.getAttribute('start-x');
    }
    
    get startX() {
      return this.getAttribute('start-x');
    }
    
    set endX(x) {
      return this.setAttribute('end-x', x);
    }
    
    get endX() {
      return this.getAttribute('end-x');
    }
  }
    
  polygraph.init = (optPrefix) => {
    const prefix = optPrefix || 'pg';
      
    window.customElements.define(prefix + '-timeline-viewer', TimelineViewer);
  };
  return polygraph;
})();

polygraph.init();
</script>
</html>